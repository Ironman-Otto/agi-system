Architectural Invariants, Terminology, and Design Notes
This section defines the non-negotiable architectural rules, terminology, and design principles governing the Cognitive Message Bus (CMB). These statements are intended to be pasted directly into the CMB Architecture document and treated as binding constraints for all current and future implementations.

1. Core Architectural Invariants
1.1 Router Authority
The CMB Router is the sole authority that binds network ports.
All modules, including GUI, Executive, Behavior, Memory, and Cognitive subsystems, must connect only.
Modules must never bind ports, regardless of channel type.
This invariant ensures centralized control, predictable topology, and consistent enforcement of routing, logging, and policy decisions.

1.2 Channel Ownership
Ports identify channels, not participants.
A channel represents a semantic communication purpose (e.g., COMMAND, BFC, DAC), not a specific module.
Multiple modules may connect to the same channel using unique identities.
Channel membership is determined by subscription and identity, not by port allocation.

1.3 Identity-Based Routing
All directed communication relies on ZeroMQ socket identity, not port numbers.
Each module must set a stable, human-readable identity equal to its logical module name.
No two live modules may share the same identity on the same channel.
Socket identity is a transport-level routing label and is not part of the application payload.

2. Ingress and Egress Terminology
2.1 Ingress
Ingress refers to traffic entering the router.
Ingress ports are always bound by the router.
Modules send messages into ingress ports using DEALER sockets.
Ingress channels represent requests, commands, data submissions, or state updates originating from modules.

2.2 Egress
Egress refers to traffic leaving the router.
Egress ports are always bound by the router.
Modules receive messages from egress ports using SUB sockets (for fanout) or DEALER sockets (for directed delivery).
Egress channels are used to distribute routed messages, broadcast events, or deliver responses.

2.3 Bidirectional (via Router)
Bidirectional communication never implies direct module-to-module connections.
All bidirectional flows are implemented as:
Module → Router (Ingress)
Router → Module (Egress)
This applies primarily to lifecycle, control, and acknowledgment channels.

3. Socket Usage Rules
3.1 ROUTER / DEALER (Directed Communication)
ROUTER/DEALER is used for all directed communication, including:
Channel ingress
ACKs and responses
Lifecycle control
ROUTER sockets provide identity-aware routing and policy enforcement.
DEALER sockets are asynchronous, non-blocking endpoints with no imposed protocol.
Directed traffic must never use PUB/SUB.

3.2 PUB / SUB (Fanout Communication)
PUB/SUB is used only for one-to-many fanout.
PUB sockets are bound by the router.
SUB sockets are used by modules to receive broadcast messages.
PUB/SUB is appropriate for: - Fanout of semantic channels - Events - Logging streams
PUB/SUB must never be used for acknowledgments, replies, or control signals.

4. Acknowledgment (ACK) Design Rules
4.1 ACK Channel Scope
ACKs are directed messages, not broadcasts.
ACKs use shared ROUTER/DEALER channels, not per-channel ports.
There is exactly:
One ACK ingress channel (Module → Router)
One ACK egress channel (Router → Module)
This avoids port explosion and duplicated logic.

4.2 ACK Semantics
ACK types are encoded in the message payload, not in port numbers.
Typical ACK states include:
RECEIVED
EXECUTING
COMPLETED
ERROR
Each ACK must reference the original message via a correlation_id.

5. Lifecycle and Control Channels
Lifecycle channels are reserved for:
Module registration
Heartbeats and liveness
Shutdown and control commands
These channels are bidirectional via the router only.
Modules must never issue lifecycle commands directly to other modules.
This design enables safe startup, shutdown, and fault handling.

6. Separation of Concerns
The CMB enforces strict separation between:
Semantic channels (what the message means)
Transport mechanics (how the message is delivered)
Routing policy (where the message goes)
Semantic meaning belongs in the message schema, not in: - Port numbers - Socket types - Hardcoded topology

7. Summary of Binding Rules (Quick Reference)
Router binds all ports
Modules only connect
Ports identify channels
Identities identify modules
ROUTER/DEALER for directed traffic
PUB/SUB for fanout only
ACKs are directed and shared
No module-to-module sockets

8. Architectural Intent
The Cognitive Message Bus is designed to behave as a policy-enforcing, identity-aware communication fabric, not a collection of point-to-point connections. This enables:
Centralized observability
Deterministic routing
Scalable module composition
Future hardware mapping
Robust fault isolation
All future extensions to the CMB must preserve these invariants.